<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="./css/style.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&family=Rubik+Mono+One&display=swap" rel="stylesheet">
        <title>Auction</title>
    </head>
<body>
    <header>
        <%- include('./partials/nav.ejs', { loggedIn: loggedIn }) %>
    </header>

    <div class="heroAuction">
        <div class="AuctionVideo">
            <video loop autoplay >
                <source src="../<%= car.videoPath %>" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
        <div class="middelSectionAuction">
            <div class="auctionDetails">
                <h2><%= car.make %> <%= car.model %></h2>
                <p class="startingPrice">Starting price: <%= car.startingPrice %> $</p>
                <div id="remainingTime" data-auction-end="<%= car.auctionEnd %>"></div> <!-- Pass auctionEnd as data attribute -->
            </div>
            <div class="AuctionInfoButton">
                <button><a href="/detailsCar/<%= car._id %>">GET MORE DETAILS</a></button>
            </div>
            <div class="currentBet">
                <p class="bet">CURRENT BET</p>
                <% if (users.length === 0) { %>
                    <p class="bid">No bid yet</p>
                <% } else { %>
                    <% users.forEach(user => { %>
                        <div class="user_bet">
                            <div class="userName">
                                <p><%= user.name %> <%= user.lastname[0] %></p>
                            </div>
                            <div class="Price">
                                <p class="bid"><%= car.currentAuctionPrice %> $</p>
                            </div>
                        </div>
                    <% }) %>
                <% } %>
            </div>
            <% if (loggedIn) { %>
                <div class="formToBet AuctionInfoButton">
                    <form action="/place-bid" method="POST">
                        <input type="number" name="bidAmount" placeholder="Enter Bid" required>
                        <input type="hidden" name="carId" value="<%= car._id %>">
                        <button type="submit">Place Bid</button>
                    </form>
                </div>
            <% } %>
        </div>
    </div>
    <script src="../js/auction.js"></script>
</body>
<footer>
    <%- include('./partials/footer.ejs') %>
</footer>
</html>
